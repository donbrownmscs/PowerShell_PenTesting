<#
 .SYNOPSIS
  Scan network for Egress Filtering.

 .DESCRIPTION
  This script shows how to scan a network for Egress Filtering.

 .EXAMPLE
  # this example shows how to execute the script.
  PS C:\> ./Lab3.3-6-EgressFiltering.ps1

 .INPUTS
  None.

 .OUTPUTS
  None.

#>

# Scan a network for Egress Filtering
1..1024 | % { echo ((new-object Net.Sockets.TcpClient).Connect("allports.exposed", $_)) "Port $_ is open" } 2>$null

# Same thing written a different way
foreach($p in 1..1024) {
	try {
		(new-object Net.Sockets.TcpClient).Connect("allports.exposed", $p)
		Write-Output "Port $p is open."
	} catch {
		# do nothing
	}
}