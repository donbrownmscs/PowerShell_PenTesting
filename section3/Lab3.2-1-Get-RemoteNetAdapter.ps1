<#
 .SYNOPSIS
  Get Remote Network Adapter Information.

 .DESCRIPTION
  This script connects to a remote machine via CimSession and queries the Network Adapter information.

 .EXAMPLE
  # this example shows how to execute the script.
  PS C:\> ./Lab3.2-1-Get-RemoteNetAdapter.ps1

 .INPUTS
  None.

 .OUTPUTS
  None.

#>

# Declare Variables
$remote = ‘qarevenge’
$session = New-CimSession -ComputerName $remote

# Query the remote Win32_NetworkAdapter 
Get-CimInstance -CimSession $session -ClassName Win32_NetworkAdapter

# Query the remote Network Adapter to see if IPEnabled is True
Get-CimInstance -CimSession $session -ClassName Win32_NetworkAdapterConfiguration -Filter "IPEnabled = 'True'" | Select-Object -Property *

# Remeber to remove the CimSession when done.
$cimSession | Remove-CimSession
