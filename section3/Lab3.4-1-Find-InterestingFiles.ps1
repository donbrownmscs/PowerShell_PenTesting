<#
 .SYNOPSIS
  Scan drive for interesting files.

 .DESCRIPTION
  This script shows how to scan a hard drive to look for files that might contain passwords, credentials, accounts, etc.

 .EXAMPLE
  # this example shows how to execute the script.
  PS C:\> ./Lab3.3-1-Find-InterestingFiles.ps1

 .INPUTS
  None.

 .OUTPUTS
  None.

#>

# Silently Continue if an error is encountered on the Get-ChildItem calls below.
$ErrorActionPreference = 'SilentlyContinue'

# Encode a plaintext string into Base64
[Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes('ArghYeMateys'))

# Decode a Base64 String back into plaintext
[Text.Encoding]::Utf8.GetString([Convert]::FromBase64String('QXJnaFllTWF0ZXlz'))

# Scan a hard drive for potentially interesting files
Get-ChildItem C:\ -Include *pass*.txt,*pass*.xml,*pass*.ini,*pass*.xlsx,*cred*,*vnc*,*.config*,*accounts* -File -Recurse

# Scan a hard drive for Sysprep or Unattended Installation files with credentials
Get-ChildItem C:\ -Include *sysprep.inf,*sysprep.xml,*sysprep.txt,*unattended.xml,*unattend.xml,*unattend.txt -File -Recurse 

# Scan a hard drive for configuration files containing a given pattern
Get-ChildItem C:\ -Include *.txt,*.xml,*.config,*.conf,*.cfg,*.ini -File -Recurse | Select-String -Pattern "password"

# Scan a hard drive for Database connection strings with plaintext credentials
Get-ChildItem C:\ -Include *.config,*.conf,*.xml -File -Recurse | Select-String -Pattern "connectionString"

# Scan a hard drive for configuration files belonging to Microsoft IIS, XAMPP, Apache, PHP or MySQL.
Get-ChildItem C:\ -Include web.config, applicationHost.config, php.ini, httpd.conf, httpd-xampp.conf, my.ini , my.cnf -File -Recurse
