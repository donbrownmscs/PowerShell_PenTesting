<#
 .SYNOPSIS
  Scan network ports on remote computers.

 .DESCRIPTION
  This script shows how to scan network ports first by showing how to scan multiple ports on one machine and then how to scan one port on multiple machines.

 .EXAMPLE
  # this example shows how to execute the script.
  PS C:\> ./Lab3.3-5-PortScans.ps1

 .INPUTS
  None.

 .OUTPUTS
  None.

#>

# Scan multiple ports on a single machine
foreach ($p in 1..1024) {
	Test-NetConnection -Port $p 10.1.1.129
}

# Scan a single port on multiple machines
foreach ($ip in 1..3) {
	Test-NetConnection -Port 80 -InformationLevel "Detailed" 10.1.1.$ip
}

# Scan multiple ports on multiple machines
1..3 | foreach { $ip = $_; 1..1024 | foreach { echo ((new-object Net.Sockets.TcpClient).Connect("10.0.0.$ip",$_)) "Port $_ is open!" } 2>$null }

# Same thing written a different way
foreach ($ip in 1..3) {
	foreach($p in 1..1024) {
		try {
			(new-object Net.Sockets.TcpClient).Connect("10.0.0.$ip",$p)
			Write-Output "Port $p is open on IP $ip"
		} catch {
			# do nothing
		}
	}
}

